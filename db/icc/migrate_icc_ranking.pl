use strict;
use warnings;

use DBI;

my $dbh = DBI->connect('dbi:Pg:dbname=ralph;host=localhost','rwuser','rwuser',{AutoCommit=>1,RaiseError=>1,PrintError=>0});
my @data = <DATA>;

for my $r (@data) {
	chomp $r;
	print "r: $r\n";
	
	my ($id, $ratingcnt, $rating) = split(/\t/, $r);
	$id        =~ s/\"//g;
	$ratingcnt =~ s/\"//g;
	$rating    =~ s/\"//g;
	
	my $sth = $dbh->prepare("

	INSERT INTO ralph.icc_interface_ranking(
	            id, ratingcnt, rating)
	    VALUES ('$id', $ratingcnt, $rating);
	");

	my $rows = $sth->execute();
}





__DATA__
"-Q24Qt2MeW0"	"36"	"1559"
"-ViAueK2gMY"	"35"	"1443"
"0lvMoVyZ7sI"	"36"	"1545"
"1-E5UGwSTA8"	"35"	"1662"
"1cZD4ukOxHE"	"36"	"1745"
"2bAB99s3AWU"	"35"	"1478"
"2ZsH0Fhzkrk"	"35"	"1618"
"34KCIgX-9sE"	"37"	"1592"
"3aHBRTZfza0"	"39"	"1547"
"3be7oT0QMBY"	"35"	"1484"
"410cEQlijds"	"37"	"1551"
"4Zkwxzsn70A"	"36"	"1620"
"5l3sVL1Kn3E"	"37"	"1560"
"5NKlZItmVro"	"34"	"1654"
"68sNO0zwwh0"	"37"	"1668"
"6XuFl-cxB9c"	"35"	"1672"
"74C7BBc7r2Y"	"37"	"1598"
"7Al0Hq2fJTw"	"37"	"1617"
"7RlwqqgCblc"	"35"	"1685"
"8-oqzHRw-W4"	"34"	"1603"
"83awjJdxn0I"	"35"	"1513"
"_cEMFG70rcQ"	"36"	"1584"
"_qhNW-hbDzc"	"35"	"1641"
"aoa1vp5FqYo"	"38"	"1684"
"awpsqcjVGC0"	"39"	"1613"
"b-XoAWoxK0M"	"37"	"1501"
"BGYquNIovWs"	"35"	"1655"
"BM_L7Iy-suE"	"36"	"1697"
"BmT_mFNCbqA"	"35"	"533"
"BoNJcj_neUI"	"34"	"1646"
"c1bZ9lSIAVw"	"36"	"1486"
"DC4tzpfBm4k"	"36"	"1601"
"Df_9jyF8bKg"	"35"	"1522"
"DnrXKYNioXE"	"36"	"1668"
"dtfaz9Q11ms"	"36"	"1599"
"EmqJGSnhUjM"	"37"	"1674"
"eqzB9eLGv6c"	"34"	"1598"
"feycWPmsE3k"	"37"	"1679"
"GGb6PLTjQLs"	"35"	"1561"
"GK6hqbTzdLQ"	"35"	"1593"
"GpeQ0A9GKKQ"	"35"	"1687"
"HHKGHp0hA1Q"	"35"	"1592"
"hQi9GRRZRNw"	"37"	"1674"
"HT4UDW_C0xA"	"36"	"1654"
"iE9CoxaekXI"	"35"	"1484"
"IY2zcWo_RoI"	"35"	"1643"
"j__dNp_Kkfk"	"34"	"1681"
"JHkvzjqYS2k"	"35"	"1469"
"jojRa0kN1cY"	"33"	"1664"
"JwLiLbs3FhM"	"36"	"1612"
"K9QCbTAiTTU"	"34"	"1712"
"KDNtf9-k4oo"	"34"	"1715"
"KKE1d4_WghE"	"35"	"1581"
"kr-0-QXL7go"	"35"	"1582"
"kSRYz4q2d1c"	"35"	"1655"
"kxLvptaMdZQ"	"34"	"1592"
"l-BOpJSAtI4"	"34"	"1535"
"L_V0wEbkQn4"	"36"	"1761"
"NcaAmTG8TVM"	"35"	"1506"
"o5aKyqSGrkw"	"35"	"1706"
"OoE5r_mVHaI"	"35"	"1754"
"OPloTlNTkIs"	"35"	"1629"
"p3ZpACu9Q2w"	"34"	"1497"
"p6jH9mj8ROI"	"38"	"1582"
"PdeEUuOBDMU"	"36"	"1493"
"PQHMHIejxa4"	"35"	"1602"
"QKMFcdv3PEY"	"35"	"1580"
"qRrZErK0wjo"	"35"	"1619"
"RDeMa7K3E3M"	"36"	"1563"
"RFImmLSw4lU"	"35"	"1614"
"RhJMUrrQQiY"	"34"	"1562"
"rZn6hk2xjCs"	"36"	"1577"
"scjNRuB-Hzg"	"36"	"1480"
"snnkUnI98hI"	"38"	"1537"
"SpjJaQMS3k4"	"36"	"1634"
"T6n1jVCZ3Ug"	"34"	"1573"
"tdVhJvMlucQ"	"35"	"1555"
"Ts1RFE8JwBM"	"34"	"1541"
"U-kIhf4e4c0"	"36"	"1687"
"UqI2z3aV1oU"	"37"	"1706"
"vH27AhEkvtA"	"36"	"1584"
"VxPW7M0LgZw"	"35"	"1652"
"WSmUMUaBwyI"	"38"	"1550"
"WXC4f2BVpNg"	"35"	"1591"
"X7NLPb5dA34"	"34"	"1515"
"x8hu7mOKxGc"	"36"	"1572"
"XH1Tv7bKmYA"	"37"	"1572"
"XhoIfaSB_RY"	"38"	"1495"
"XTwbzgl1jS0"	"36"	"1628"
"y2L5bf6rl5o"	"36"	"1497"
"yBBGpALKMvg"	"35"	"1718"
"YCDsHsSmCM4"	"34"	"1571"
"yNvjdoQO-Q0"	"34"	"1648"
"zAyZKqlzmWs"	"35"	"1623"
"zCwUsjZLTiU"	"38"	"1680"
"zm-YIdK9dNE"	"36"	"1679"
"ZT8mNyDgv-8"	"36"	"1728"
"A5CVgeV4WTI"	"34"	"1707"
"xYGrS__41po"	"34"	"1703"
"-AfKWhYILI0"	"38"	"1610"
"UM1_CNcy5VY"	"35"	"1740"
"LSMIysKBSKA"	"34"	"1682"
"6UfC8Fd8RA0"	"34"	"1680"
"xQWyH5INeDs"	"34"	"1591"
"EZ_zYBgzqcI"	"34"	"1680"
"gWMoZQMqKEo"	"36"	"1471"
"A56iRk6NkJc"	"36"	"1648"
"8ElyOVoqTNg"	"35"	"1648"
"2arrJ5kdcKQ"	"36"	"1530"
"o7Woq4LgFHo"	"34"	"1726"
"QOSxeOW1IHU"	"35"	"1682"
"KqPNSLHz84w"	"35"	"1672"
"9V1fXFM_CDA"	"37"	"1676"
"CFmSkhEXCwg"	"35"	"1584"
"cgWuJx-G4BM"	"35"	"1672"
"A_xl8qugVGM"	"35"	"1759"
"J3zo5Ea-z38"	"33"	"1668"
"czINvlgrfrI"	"38"	"1671"
"roDwTqBD6iY"	"35"	"1680"
"QtCQEmEglLQ"	"35"	"1693"
"rg0Q0PKEVp4"	"34"	"1573"
"eR5ZT49mBTE"	"36"	"1633"
"uOCGvn2-xiE"	"34"	"1567"
"hMPyKJZMOsU"	"36"	"1708"
"HlWpPze9PKM"	"36"	"1596"
"tDXdIvfNIbo"	"39"	"141"
"negE_KoM6d0"	"34"	"1566"
"TNpthw4FebI"	"34"	"1676"
"wJGbt0-xlMw"	"34"	"1582"
"THkMcwdMx6A"	"36"	"1618"
"x1zUl9hor8s"	"37"	"1543"
"oQaIDhZg2PY"	"34"	"1596"
"xHHvLn1IqeI"	"35"	"1616"
"UGkLoExRksM"	"37"	"1587"
"iymmBZuiK0E"	"35"	"1604"
